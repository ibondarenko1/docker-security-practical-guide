package docker.security

import rego.v1

# Deny privileged containers
deny contains msg if {
    input.HostConfig.Privileged == true
    msg := "Container is running in privileged mode"
}

# Deny containers running as root
deny contains msg if {
    input.Config.User == ""
    msg := "Container is running as root user"
}

# Warn about missing health checks
warn contains msg if {
    not input.Config.Healthcheck
    msg := "Container has no health check configured"
}

# Check for exposed ports
warn contains msg if {
    count(input.Config.ExposedPorts) > 5
    msg := "Container exposes more than 5 ports"
}